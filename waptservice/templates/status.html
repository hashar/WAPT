{% extends "layout.html" %}
{% block content %}

<h1>Installed packages</h1>'
<table border=1 cellspacing=0 cellpadding=4 class=sample>
{% set cols = [('install_status','Status'),('package','Package'),('version','Version'),('install_par','Installed by'),('install_date','Installed on'),('repo_version','Version repo'),('install_output','Traces')] %}
	<tr>
		{% for c in cols %}
			<th>{{c[1]}}</th>
		{% endfor %}
		<th>Action<th>
	</tr>
	{% for p in packages %}
        {%if p.get('install_status')=='OK'%}
            {%if Version(p['version']) < Version(p.get('repo_version','') or '') %}
        		<tr class=status-upgradable>
            {%elif Version(p['version']) == Version(p.get('repo_version','') or '') %}
        		<tr class=status-installed>
            {%else%}
        		<tr>
            {%endif%}
        {%elif p.get('install_status')=='ERROR'%}
            <tr class=status-error>
        {%else%}
    		<tr>
        {%endif%}

		{% for c in cols %}
		<td>
		{%if c[0]=='install_date' %}
			{{format_isodate(p[c[0]])}}
		{%elif c[0]=='install_output' %}
			{{p[c[0]].replace('\n','<br>')|safe}}
		{%else%}
			{{p[c[0]] or '-'}}
		{%endif%}
		</td>
		{% endfor %}
		<td><a href="remove?package={{p.package}}">Remove</a></td>
	</tr>
{% endfor %}
</table>
{% endblock %}
